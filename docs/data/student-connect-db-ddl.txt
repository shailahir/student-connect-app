-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


DROP TABLE IF EXISTS app.group_memberships;

CREATE TABLE IF NOT EXISTS app.group_memberships
(

    CONSTRAINT group_memberships_pkey PRIMARY KEY (id)
);

DROP TABLE IF EXISTS app.group_memberships_history;

CREATE TABLE IF NOT EXISTS app.group_memberships_history
(

    CONSTRAINT group_memberships_history_pkey PRIMARY KEY (history_id)
);

DROP TABLE IF EXISTS app.groups;

CREATE TABLE IF NOT EXISTS app.groups
(

    CONSTRAINT groups_pkey PRIMARY KEY (id)
);

DROP TABLE IF EXISTS app.groups_history;

CREATE TABLE IF NOT EXISTS app.groups_history
(

    CONSTRAINT groups_history_pkey PRIMARY KEY (history_id)
);

DROP TABLE IF EXISTS app.message_deliveries;

CREATE TABLE IF NOT EXISTS app.message_deliveries
(

    CONSTRAINT message_deliveries_pkey PRIMARY KEY (id)
);

DROP TABLE IF EXISTS app.message_deliveries_history;

CREATE TABLE IF NOT EXISTS app.message_deliveries_history
(

    CONSTRAINT message_deliveries_history_pkey PRIMARY KEY (history_id)
);

DROP TABLE IF EXISTS app.message_receivers;

CREATE TABLE IF NOT EXISTS app.message_receivers
(

    CONSTRAINT message_receivers_pkey PRIMARY KEY (id)
);

DROP TABLE IF EXISTS app.message_receivers_history;

CREATE TABLE IF NOT EXISTS app.message_receivers_history
(

    CONSTRAINT message_receivers_history_pkey PRIMARY KEY (history_id)
);

DROP TABLE IF EXISTS app.message_schedules;

CREATE TABLE IF NOT EXISTS app.message_schedules
(

    CONSTRAINT message_schedules_pkey PRIMARY KEY (id)
);

DROP TABLE IF EXISTS app.message_schedules_history;

CREATE TABLE IF NOT EXISTS app.message_schedules_history
(

    CONSTRAINT message_schedules_history_pkey PRIMARY KEY (history_id)
);

DROP TABLE IF EXISTS app.messages;

CREATE TABLE IF NOT EXISTS app.messages
(

    CONSTRAINT messages_pkey PRIMARY KEY (id)
);

DROP TABLE IF EXISTS app.messages_history;

CREATE TABLE IF NOT EXISTS app.messages_history
(

    CONSTRAINT messages_history_pkey PRIMARY KEY (history_id)
);

DROP TABLE IF EXISTS app.students;

CREATE TABLE IF NOT EXISTS app.students
(

    CONSTRAINT students_pkey PRIMARY KEY (roll_number)
);

DROP TABLE IF EXISTS app.students_history;

CREATE TABLE IF NOT EXISTS app.students_history
(

    CONSTRAINT students_history_pkey PRIMARY KEY (history_id)
);

DROP TABLE IF EXISTS ref.delivery_status_types;

CREATE TABLE IF NOT EXISTS ref.delivery_status_types
(

    CONSTRAINT delivery_status_types_pkey PRIMARY KEY (id)
);

DROP TABLE IF EXISTS ref.message_types;

CREATE TABLE IF NOT EXISTS ref.message_types
(

    CONSTRAINT message_types_pkey PRIMARY KEY (id)
);

DROP TABLE IF EXISTS ref.scheduler_status_types;

CREATE TABLE IF NOT EXISTS ref.scheduler_status_types
(

    CONSTRAINT scheduler_status_types_pkey PRIMARY KEY (id)
);

ALTER TABLE IF EXISTS app.group_memberships
    ADD CONSTRAINT fkcsdrrv8t0qyxw1vdx8d3apwh3 FOREIGN KEY (group_id)
    REFERENCES app.groups (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS app.group_memberships
    ADD CONSTRAINT fkh1c3rtedq8jbhnww0m6jmcggv FOREIGN KEY (student_id)
    REFERENCES app.students (roll_number) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS app.group_memberships_history
    ADD CONSTRAINT fkm02vprdaq4ub4awpqt2u02d9p FOREIGN KEY (id)
    REFERENCES app.group_memberships (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS app.groups_history
    ADD CONSTRAINT fka43d53fgmce2t8vwjf9kud0er FOREIGN KEY (id)
    REFERENCES app.groups (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS app.message_deliveries
    ADD CONSTRAINT fk3yq0i8oqcvsvfy12nyq7to453 FOREIGN KEY (receiver_id)
    REFERENCES app.message_receivers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS app.message_deliveries
    ADD CONSTRAINT fkhdsue12aiyeteys28y308kpj4 FOREIGN KEY (message_id)
    REFERENCES app.messages (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS app.message_deliveries
    ADD CONSTRAINT fkhv7lkv5kqqrtbtccyea59cnat FOREIGN KEY (schedule_id)
    REFERENCES app.message_schedules (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS app.message_deliveries_history
    ADD CONSTRAINT fkod7t1a5p7ujr11pm790vlxpxy FOREIGN KEY (id)
    REFERENCES app.message_deliveries (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS app.message_receivers
    ADD CONSTRAINT fkq35xcj1lcggp66rh1cley1ib6 FOREIGN KEY (student_id)
    REFERENCES app.students (roll_number) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS app.message_receivers
    ADD CONSTRAINT fkqo0ye7kcad9rwk3al53u9m17 FOREIGN KEY (message_id)
    REFERENCES app.messages (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS app.message_receivers_history
    ADD CONSTRAINT fk34rctjgjjrp13kdobb7iee0uh FOREIGN KEY (id)
    REFERENCES app.message_receivers (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS app.message_schedules
    ADD CONSTRAINT fk1li2wffug5rku98oxm6eop4t3 FOREIGN KEY (message_id)
    REFERENCES app.messages (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS app.message_schedules_history
    ADD CONSTRAINT fkdbyjuhwvos2bsopdvmxw5kn4v FOREIGN KEY (id)
    REFERENCES app.message_schedules (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS app.messages_history
    ADD CONSTRAINT fkgmaj5e6w6hqah9pdqbhvkdc4b FOREIGN KEY (id)
    REFERENCES app.messages (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS app.students_history
    ADD CONSTRAINT fktqaxabips6qg5hq6jjdpat7ck FOREIGN KEY (roll_number)
    REFERENCES app.students (roll_number) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;

END;